<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <mate name="viewport" content="width=device-width" />
    <title>SCOUT.</title>
    <link href="style/homestyle.css" rel="stylesheet" />
    <link href="style/actionstyle.css" rel="stylesheet" />
    <script src="src/js/map_scala.js"></script>
    <script src="src/js/map.js"></script>
    <script src="build/clustering.js"></script>
    <script src="src/js/interact.js"></script>
    <script src="src/js/cluster.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@sgratzl/chartjs-chart-boxplot"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="src/js/map_scala.js"></script>

    <!--   Website-spesific Style   -->
    <style>
      header {
        display: flex;
        align-items: center;
        font-size: 30px;
        font-weight: 600;
        color: black;
        text-shadow: 1px 1px 20px rgba(255, 255, 255, 1);
        margin: 10px 20px;
      }

      textarea {
        width: 70%;
        height: 100%;
        min-width: 200px;
        min-height: 100px;
        text-align: left;
        font-size: larger;
        font-family: sans-serif;
        background-color: #d8d8d8;
        border-radius: 5px;
      }

      select {
        display: inline-block;
        font-family: inherit;
        text-align: center;
        border: none;
        outline: 1px dotted rgb(37, 37, 37);
        outline-offset: -4px;
        background: hsl(0deg 0% 75%);
        width: 150px;
        height: 40px;
        box-shadow:
          inset -1px -1px #292929,
          inset 1px 1px #fff,
          inset -2px -2px rgb(158, 158, 158),
          inset 2px 2px #ffffff;
        font-size: 10px;
        text-transform: uppercase;
        letter-spacing: 1px;
        padding: 5px 30px;
      }

      .dropdown-container {
        display: none;
      }

      .visible {
        display: block;
      }

      #result {
        display: none;
      }

      #mapHTMLContainer {
        transform: scale(1);
        position: relative;
      }

      .distFunc {
        display: none;
        margin: auto;
      }

      .directRunBtn {
        display: none;
      }
    </style>
  </head>
</html>

<body>
  <!--This is the mini navigation of the site-->
  <nav>
    <div class="logo">
      <span>SCOUT.</span>
    </div>
    <ul>
      <li><a href="index.html">Home Page</a></li>
      <li><a href="manual.html">Manual</a></li>
    </ul>
  </nav>

  <main style="text-align: center">
    <div class="box" id="prepare" style="z-index: 2">
      <div class="label">
        <p style="text-align: left">Upload your CSV file</p>
      </div>

      <!-- Input Area for data -->
      <textarea
        id="text_box"
        name="textinput"
        placeholder="Type here..."
      ></textarea>
      <!-- Formal and real button for add data -->
      <div>
        <button id="addDataButton" style="width: 200px">Add Data</button>
        <button
          id="myButton"
          style="width: 200px"
          onclick="showCSVDeviderPopUp()"
        >
          CSV-Divider
        </button>
      </div>
      <!-- textbox to choose how columns are separated in csv -->
      <div id="CSVDeviderPopUp" style="display: none">
        <input
          type="text"
          id="myCSVDeviderInput"
          placeholder="default is commas"
          class="divider"
        />
      </div>
      <!---button to import your formerly exported data-->
      <button
        type="button"
        id="directRun"
        class="directRunBtn"
        onclick="importFile();"
      >
        Run Directly
      </button>

      <!-- Only CSV and JSON data types are accepted -->
      <input
        type="file"
        id="dataFile"
        name="dataFile"
        accept=".CSV,.JSON"
        style="display: none"
      />
      <!--Table interpretation-->
      <div class="box" id="box-for-check-list">
        <div id="checkFlagArea" style="display: none">
          <div class="label">
            <p style="text-align: left">Flag match</p>
          </div>
          <p id="flag_guide" style="text-align: left; margin-left: 60px"></p>
          <table
            id="checkTable"
            style="
              border-collapse: collapse;
              margin-left: 50px;
              padding-left: 50px;
            "
          >
            <thead>
              <tr>
                <th>Column number</th>
                <th>Column title</th>
                <th>Data flags</th>
              </tr>
            </thead>

            <tbody></tbody>
          </table>
        </div>
      </div>

      <div class="box" id="box-for-button-group">
        <!-- Choose Function Button -->
        <div style="min-height: 80px">
          <div class="label">
            <p style="text-align: left">Choose clustering</p>
          </div>
          <select id="DataType" style="width: 200px; margin-top: 20px">
            <option
              value="noChoice"
              onclick="document.getElementById('distFunction').style.display='none'"
            >
              Choose your data type
            </option>
            <option
              value="Seq"
              onclick="document.getElementById('distFunction').style.display='none'"
            >
              DNA/RNA Sequence
            </option>
            <option
              value="ChemInfo"
              onclick="document.getElementById('distFunction').style.display='none'"
            >
              Molecule Information
            </option>
            <option
              value="Vector"
              onclick="document.getElementById('distFunction').style.display='none'"
            >
              Vector
            </option>
            <option
              value="Custom"
              onclick="document.getElementById('distFunction').style.display='inline'"
            >
              Custom
            </option>
            <option
              value="Preclustered"
              onclick="document.getElementById('distFunction').style.display='inline'"
            >
              Preclustered
            </option>
            <!-- value="Vector" was former "Euclidean" -->
          </select>

          <select id="D_function" style="display: none; width: 200px">
            <option value="noChoice">Choose a Function</option>
          </select>

          <div>
            <select
              id="Scaling_alg"
              name="SaclingAlgorithmus"
              style="width: 200px"
            >
              <option value="noChoice">Scaling Algorithm</option>
              <!-- the following values are supposed to uniqueley indentify their scaling algorithm -->
              <option value="1">SMACOF</option>
              <option value="2">SciKit-learn</option>
              <option value="3">Glimmer</option>
            </select>

            <select
              id="Distance_calcu"
              name="distance_calcu"
              style="width: 200px"
            >
            <!-- to choose which distance update the hierarchical clustering should use -->
              <option value="noChoice">Distance Calculation</option>
              <option value="0">Single</option>
              <option value="1">Complete</option>
              <option value="2">Average</option>
              <option value="3">Median</option>
              <option value="4">Weighted</option>
              <option value="5">Ward</option>
              <option value="6">Centroid</option>
            </select>
            <!-- selection of zoom-mode -->
            <select id="zoom_mode" name="zoom_mode" style="width: 200px">
              <option value="noChoice">Zoom Mode</option>
              <option value="auto" onclick="showZoomAutoPopup()">
                Automatic
              </option>
              <option value="custom" onclick="showZoomCustomPopup()">
                Custom
              </option>
            </select>
             <!-- text box for individually taking in number of zoomlevels -->
            <div id="AutoZoomPopUp" style="display: none; margin-left: 400px">
              <input
                type="text"
                id="AutoZoomInput"
                placeholder="number zoomlevels"
                class="zoomlevel"
              />
            </div>
            <!-- text box for individually taking in number of new clusters per zoomlevel -->
            <div id="CustomZoomPopUp" style="display: none; margin-left: 400px">
              <input
                type="text"
                id="CustomZoomInput"
                placeholder="number new clusters/level"
                class="zoomlevel"
              />
            </div>
          </div>
        </div>
        <br />
        <!-- text box for javascript function that gets evaluated for distance calculation -->
        <textarea
          placeholder="Enter custom distance function"
          id="distFunction"
          class="distFunc"
        ></textarea>
      </div>
      <div>
        <div class="label">
          <p style="text-align: left">Table Interpretation</p>
        </div>
        <!-- Flag check button -->
        <button
          id="colFlag_button"
          onclick="ColFlagCheck()"
          style="margin-top: 20px"
        >
          Flag Check
        </button>
        <!-- Delete All Button -->
        <button id="deleAllButton" onclick="deletedatenandfunc()">
          Delete All
        </button>
      </div>
      <div>
        <div class="label">
          <p style="text-align: left">Get your map now</p>
        </div>
      </div>
      <div>
        <!-- Run function Button -->
        <button
          id="runFuncButton"
          onclick="dealwithrun()"
          style="margin-top: 20px"
        >
          Run
        </button>
      </div>
    </div>

    <!-- Here for result, will only be showed after click -->
    <div id="result" style="margin-left: 20px">
      <div
        id="clusterInfoBox"
        style="
          text-align: left;
          border: 1px solid;
          width: 30%;
          background-color: rgba(165, 165, 165, 0.6);
        "
      ></div>

      <div
        id="mapContainer"
        style="border: none; width: auto; overflow: hidden"
      >
        <!--Buttons shown only on the map page-->
        <button
          id="switchbtn"
          type="button"
          value="preview"
          style="position: relative; float: left; margin-left: 5px; z-index: 5"
          onclick="MapViewSwitcher()"
        >
          Full Screen
        </button>
        <button
          id="BackButton2"
          style="position: relative; float: left; z-index: 5"
          onclick="window.location.reload();"
        >
          Restart
        </button>
        <button
          id="ExportButton"
          style="position: relative; float: left; z-index: 5"
          onclick="exportFile();"
        >
          Export
        </button>

        <!--The real map container-->
        <div
          id="chartContainer"
          style="border: red; position: relative; z-index: 4; width: 1330px"
        ></div>
      </div>
    </div>
  </main>
  <!-- Error message, when js is disabled.-->
  <noscript>
    <div id="nojs">
      Error: JavaScript is not enabled in your browser. Please enable it for the
      best experience.
    </div>
  </noscript>

  <footer></footer>
</body>

<script>
  //button to choose csv for data upload
  document
    .getElementById("addDataButton")
    .addEventListener("click", function () {
      document.getElementById("dataFile").click();
    });
  // call function for input parsing
  document.getElementById("dataFile").addEventListener("change", function () {
    readFileContents();
  });

  document.addEventListener("DOMContentLoaded", function () {
    var statusElement = document.getElementById("js-status");

    // Update the status element to indicate whether JavaScript is enabled.
    if (statusElement) {
      statusElement.innerHTML = "JavaScript is enabled!";
      statusElement.style.color = "green";
    }
  });

  // To avoid repetitive function selectors.
  document.getElementById("DataType").addEventListener("change", function () {
    let distance_func_list = selectDataType();
    console.log(distance_func_list);
    clean_fun_slector();
    changedistancefunclist(distance_func_list);
  });
</script>
